# 需求规格说明书 

[TOC]

| 版本 |    日期    |   描述   |  作者   |
| :--: | :--------: | :------: | :-----: |
| 1.0  | 2019-04-22 | 初稿草图 | lordrou |



## 6.1 Usecase Diagram and UML Activity Diagram（用例图，业务过程/多泳道图）

###用例图

![usecase](https://LeonhardE.github.io/images/小欣餐饮png/usecase.png)

### 泳道图

![yongdao](https://LeonhardE.github.io/images/小欣餐饮png/yongdao.png)

## 6.2 Use Cases（用例+活动图）

###详述用例

#### 用例名称：顾客点餐

* 范围：小欣餐饮公司旗下点餐系统

* 级别：用户目标

* 主要参与者：顾客

* 涉及者及关注点：
  * 顾客：可以预选用餐时间和用餐方式，清晰地看到本店当天所有的活动、套餐和单品菜式。
  * 服务员：可以看到顾客的到店时间和配餐时间以便对顾客进行服务。
  * 配送团队：可以及时从餐厅拿到餐点并且在顾客预定时间送达餐点。
  * 后厨：及时看到订单更新以便调整餐点制作、原材料库存。
  * 餐厅经理：可以方便的配置每天的上架餐点；满足顾客的需求；能及时看到顾客的评价以便及时解决顾客对餐厅服务的不满；单位时间内的营收金额。
  * 支付授权服务：希望接受到格式和协议正确的数字授权请求。希望准确计算对餐馆的应付款。
* 前置条件：顾客通过扫码或其他方式进入点餐小程序
* 后置条件：
  * 存储销售信息
  * 准确计算税金
  * 更新账务和库存信息
  * 记录提成
  * 生成票据
  * 记录支付授权的批准
* 基本流程：
  1. 点餐顾客通过扫码或其他方式进入点餐小程序。
  2. 点餐顾客选择用餐方式（配送或堂食）和用餐时间。
  3. 点餐顾客浏览今日菜单，并选择餐点份数，添加进购物车。
  4. 点餐顾客在购物车进行结算，可增加用餐备注。
  5. 外卖顾客在预定时间收到配送团队送到的餐点。
  6. 堂食顾客收到餐厅服务员的配餐服务。
  7. 点餐顾客在收到餐点前申请修改订单，若餐厅经理同意申请，则订单取消，若餐点已经备好，经理驳回申请。
  8. 点餐顾客用餐完毕后对本次用餐进行评价，若顾客不满意此次用餐，餐厅经理与顾客协商解决办法直至顾客满意。
* 替代流程：
  1. 顾客在点餐过程中闪退：
     * 系统自动保存当前顾客的用餐状态
     * 顾客重新进入系统，系统回复顾客推出前的界面信息
  2. 顾客在点餐过程中发现库存不足：
     * 剩余库存较少的餐点旁备注剩余数量
     * 餐点无法加入购物车
  3. 顾客结账后，后厨发现库存不足：
     * 经理致电顾客并表示歉意，与顾客协商解决办法
  4. 顾客无法使用微信支付进行结算：
     * 堂食订单可以在经理协助下进行其他支付方式（现金、支付宝或信用卡）
* 特殊需求
  * 其他语言（英语版本）
  * 在其他app上的使用
* 发生频率：
  * 可能会不间断发生
* 未解决问题：
  * 外送单的其他支付方式
  * 配送团队的效率问题
  * 堂食顾客不按时到达餐厅就餐

​	

### 非正式用例

####用例名称：餐厅管理菜品

* 主成功场景：

  * 餐厅营业前，后厨根据每日采购情况与经理制定当天活动、套餐及单品并上架菜品。
  * 餐厅营业中，菜品库存根据顾客订单数量及时变更，库存不足时下架该菜品。
  * 餐厅营业中，菜品库存及时更新，30s刷新一次。
  * 顾客点单过程中，菜品库存不足无法加入购物车。

* 交替场景：

  * 顾客下单后取消餐点，联系经理后成功取消库存不变。
  * 顾客下单后后厨发现库存不足，经理联系顾客商量解决方案。

* 用例图：

  ![6.2(1)](https://LeonhardE.github.io/images/小欣餐饮png/6.2(1).jpg)

####用例名称：顾客点评订单

- 主成功场景：

  - 订单完成后，顾客对用餐体验进行评价。
  - 顾客评价不佳，餐厅经理及时与顾客进行联系，并协商解决方法。
  - 顾客评价良好，餐厅经理在评价回复处对顾客表示感谢。

- 交替场景：

  - 顾客恶意差评，餐厅经理将其拉入餐厅黑名单。

- 用例图：

  ![6.2(2)](https://LeonhardE.github.io/images/小欣餐饮png/6.2(2).jpg)

- 活动图：

  ![6.2(3)](https://LeonhardE.github.io/images/小欣餐饮png/6.2(3).jpg)

### 简述用例

#### 用例名称：外送员配送

####用例名称：餐厅经理查询评价

#### 用例名称：餐厅收入统计

##6.3 Domian Models（领域模型）

![WechatIMG42142](https://LeonhardE.github.io/images/小欣餐饮png/WechatIMG42142.png)

##6.4 State Models（状态模型）

状态图中描述的对象是领域模型中的订单对象

![6.4](https://LeonhardE.github.io/images/小欣餐饮png/6.4.jpeg)

##6.5 System Sequence Diagrams（功能模型）

##6.6 Supplementary Requirements（补充需求）

### 简介

本文档记录了 “小欣餐饮” 未在用例中描述的需求

###功能性

1. **日志和错误处理**。在持久性存储中记录错误历史

2. **安全性**。下单的微信用户都需要通过认证

3. 菜品管理

   。

   - 一个菜品只能属于一个分类，也就明确了分类的管理方式。
   - 明确了价格与规格的方案，具体来说是：菜品依据规格定价，每个菜品有一个基础价格，再加上规格的组合确定最终价格——每个规格选项对应一个价格的增量或者减量。卡片上会显示“最低￥ 起”（若有价格区间），菜品详情会显示一组默认规格。
   - 增加排序功能，菜品和分类都需要排序以调整显示上的先后。
   - 明确了tag的管理，具体来说是：每个菜品用几个字符串字段表示几个自定义tag，也支持辣度这样特殊的tag单独做一个字段。

###可用性

1. 辅助功能

   。残障人士顾客将能快速选中自己喜欢的内容，因此

   - 避免使用色盲人群难以识别的颜色
   - 重点信息应当突出，避免使用太多吸引注意的颜色

2. 用户体验

   - 查找菜品时提供模糊匹配
   - 支持多人同时点餐

### 可靠性

1. **可恢复性**。如果在使用外部服务（如微信支付等）时出现错误，为了完成销售交易，应该有本地方案（如存储转发）加以解决
2. **性能**。购买者希望能非常快速地完成销售处理过程，所以我们应当尽量减少页面的等待时间，加载资源应当尽量的少。

### 可支持性

1. **可适应性**。对于不同品牌和尺寸的设备，如 Apple iPhone X，Mix2 等等，我们需要保证页面一致性
2. **支付方式**。顾客除了可以使用线上微信支付的方式支付订单外，还可以线下与商家自行协商买单。

###实现约束

- 客户端：选择使用微信小程序，一种基于微信的服务形式，比起Web应用更加接近原生态，而且用户省去安装App的时间，提高用户体验；小程序开发使用WePY框架，能够组件化、单文件开发。
- 商家端：选择使用Web端，商家对产品的功能完整性有较高的需求；基于开发难度和社区活力的考虑，Web框架使用Vue进行SPA应用开发。
- 后端框架：基于技术和业务层面的考虑，选择Node.js作为编程语言，Koa作为Web框架。

###免费开源构建

一般而言我们建议在该项目中尽可能使用开源构件。尽管现在对最终的设计选择构件为时过早，但是我们建议采用

- JLog 日志框架
- Docker
- MySQL
- …

###法律问题

1. 商家在菜单展示的商品信息必须属实，并对于消费者提出的有权知悉的情况的问题，应予以告知，不可以隐瞒欺骗，本平台要求商家上交经营许可证之类的证明也是为了保护消费者的知悉真实情况权益

   > 消费者拥有“知悉真实情况权” 即消费者所享有的知悉其购买、使用的商品的过程中或者接受的服务的真实情况的权利。消费者有权知悉的情况具体包括商品的价格、产地、生产者、用途、性能、规格、等级、主要成份、生产日期、有效期限、检验合格证明、使用方法说明书、售后服务，或者服务的内容、规格、费用等等。 *选自《中华人民共和国消费者权益保护法》*

2. 消费者在我们的点餐平台上可以自主选择，不会给商家有强制销售的漏洞，让消费者放心，“选啥买啥”、“买多少花多少钱”

   > 消费者拥有“自主选择权”
   > 即消费者自主选择商品或者服务的权利。包括两方面：一是对商品的品种、服务方式及其提供者应有充分选择的余地;二是对于选择商品服务及其提供者应有自由决定的权利而不受强制。实际生活中，损害消费者自由选择权的现象主要是“官商”习气、商品搭售和强买强卖等。
   > *选自《中华人民共和国消费者权益保护法》*

3. 本点餐系统平台保证在价格计算方面不会出现计量失误；消费者在符合要求的情况下，可以申请取消订单。对于订单的详情，本平台会予以详细准确永久性的记录

   > 消费者拥有“公平交易权”。
   > 是指消费者在购买商品或者接受服务时，有权获得质量保障、价格公平合理、计量准确无误等公平交易条件，有权拒绝经营者的强制交易。
   > A. 关于商品和服务的质量，消费者有权要求其符合国家规定的标准或者与生产经营者约定的标准，不致因质量低劣而妨碍消费。如果经营者提供的商品或者服务不符合规定的质量要求，消费者有权要求修理、更换、退货、降价等。
   > B. 关于商品和服务的价格，消费者有权要求生产经营者执行国家的价格政策、法规或按质论价，商品价格或服务费用合理，不因乱涨价或乱收费而受到经济利益损失。
   > C. 关于商品和服务的计量，消费者有权要求生产经营者计量准确、足量，不致因短尺少秤而遭受经济利益损害。生产经营者更应自觉守法，遵守职业道德，不在计量上弄虚作假。对于工厂包装的产品，消费者有权要求其注明净重量或容量，并与实际相符;交易时计量的商品，消费者有权查明度量、衡器是否准确，有权看秤、复秤，对不足分量者有权要求退货或退回多收的价款
   > *选自《中华人民共和国消费者权益保护法》*